<nav class="navbar bg-none container">
  <div class="row justify-content-center sl">
    <a class="mt-3 navbar-brand tip" href="/record/create"><img src="/image/logo2.png" alt="" width="120px">
      <span class="tip-text">新增支出</span>
    </a>
  </div>
</nav>

<div class="container index-container">
  <!-- 總金額 -->
  <sapn class="total-amount" id="total-amount">
    {{totalAmountFormat}}
  </sapn>
  <!-- 分類 -->
  <div class=" filter row">
    <!-- 分類: 月份 -->
    <div class="filter-months">
      <form name="filter-months" method="GET" action="/record/months">
        <select class="form-control" id="filter-month" name="months" onchange="submit()">
          <option value="">月份</option>
          {{#each months}}
          <option value="{{this}}">{{this}}</option>
          {{/each}}
        </select>
      </form>
    </div>
    <!-- 分類: 類別 -->
    <div class="filter-category mb-4">
      <form name="filter-category" method="GET" action="/record/category">
        <select class="form-control" id="filter-category" name="filter" onchange="submit()">
          <option>{{filter}}</option>
          <option value="餐飲食品">餐飲食品</option>
          <option value="休閒娛樂">休閒娛樂</option>
          <option value="家居物業">家居物業</option>
          <option value="交通出行">交通出行</option>
          <option value="其他">其他</option>
          <option value="">全部支出</option>
        </select>
      </form>
    </div>
  </div>
  <!-- 支出清單 -->
  <div class="container mb-5 record-list">
    <div class="row justify-content-center">
      {{#if noExpense}}
      <div class="no-expense">Hello, {{username}}
        <p> Click the piggy to add expense.</p>
      </div>
      {{/if}}
      {{#each record}}
      <div class="col-1">
      </div>
      <div class="col-10"><a href="/record/{{this._id}}">
          <li class="list-group-item" data-id="{{@index}}" style="">
            <div class="row justify-content-between align-items-center">
              <div class="row">
                <div class="category-icon">{{{this.icon}}}</div>
                <div>
                  <h5 class="ml-2 list-name">{{this.name}}</h5>
                  <h6 class="ml-2 list-date">{{this.date}}</h6>
                  <h6 class="ml-2 list-date">{{this.merchant}}</h6>
                </div>
              </div class="amount">
              <h5 class="mr-2 list-amount"> {{this.amount}}</h5>
            </div>
          </li>
        </a>
      </div>
      <div class="col-1">
        <form action="/record/{{this._id}}?_method=DELETE" method="POST" onsubmit="return confirm('確定要刪除嗎？')">
          <button type="submit" class="delete-btn">
            <i class="fas fa-times"></i>
          </button>
        </form>
      </div>
      {{/each}}
    </div>
  </div>
  <!-- footer -->
  <footer>
    <div class="footer pb-5">
      <a class="logout" href="/users/logout"><img src="/image/logout.png" width="45px" alt="">
        <span class="logout-text">登出</span>
      </a>
    </div>
  </footer>
</div>

<script>
  const totalAmountText = document.getElementById('total-amount').innerText
  const totalAmountDOM = document.getElementById('total-amount')
  const totalAmount = formatToNumber(totalAmountText)
  function formatToNumber(totalAmountText) {
    totalAmountText = totalAmountText.split(',').join('')
    return Number(totalAmountText)
  }
  if (totalAmount < 1000) { totalAmountDOM.style.color = '#EBD21C' }
  if (totalAmount >= 1000) { totalAmountDOM.style.color = '#FFC300' }
  if (totalAmount > 5000) { totalAmountDOM.style.color = '#EB961C' }
  if (totalAmount > 10000) { totalAmountDOM.style.color = '#DB6D29' }
  if (totalAmount > 50000) { totalAmountDOM.style.color = '#B03118' }
</script>