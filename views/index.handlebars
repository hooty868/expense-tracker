<nav class="navbar bg-none container">
  <div class="row justify-content-center sl">
    <a class="mt-3 navbar-brand tip" href="/record/create"><img src="/image/logo2.png" alt="" width="120px">
      <span class="tip-text">新增支出</span>
    </a>
  </div>
</nav>

<div class="container index-container">
  <!-- 總金額 -->
  <sapn class="total-amount" id="total-amount">
    {{totalAmountFormat}}
  </sapn>
  <div class="chart-container">
    <canvas id="myChart" width="300" height="300"></canvas>
  </div>
  <!-- filter -->
  <!-- 月份 -->
  <form method="GET" action="/filter">
    <div class="filter row">
      <div class="filter-months">
        <select class="form-control" id="filter-month" name="months" onchange="submit()">
          {{#if selectMonth}}<option>{{selectMonth}}</option>{{/if}}
          <option value="">全部月份</option>
          {{#each months}}
          <option value="{{this}}">{{this}}</option>
          {{/each}}
        </select>
      </div>
      <!-- 類別 -->
      <div class="filter-category mb-4">
        <select class="form-control" id="filter-category" name="categories" onchange="submit()">
          {{#if selectCategory}}<option>{{selectCategory}}</option>{{/if}}
          <option value="">全部支出</option>
          {{#each categories}}
          <option value="{{this}}">{{this}}</option>
          {{/each}}
        </select>
      </div>
    </div>
  </form>
  <!-- 支出清單 -->
  <div class="container mb-5 record-list">
    <div class="row justify-content-center">
      {{#if noExpense}}
      <div class="no-expense">Hello, {{username}}
        <p> Click the piggy to add expense.</p>
      </div>
      {{/if}}
      {{#if noRecord}}
      <div class="no-record mt-5">
        <h4>{{selectMonth}} {{selectCategory}} ，沒有支出紀錄。</h4>
      </div>
      {{/if}}
      {{#each record}}
      <div class="col-1">
      </div>
      <div class="col-10"><a href="/record/{{this._id}}">
          <li class="list-group-item" data-id="{{@index}}" style="">
            <div class="row justify-content-between align-items-center">
              <div class="row">
                <div class="category-icon">{{{this.icon}}}</div>
                <div>
                  <h5 class="ml-2 list-name">{{this.name}}</h5>
                  <h6 class="ml-2 list-date">{{this.date}}</h6>
                  <h6 class="ml-2 list-date">{{this.merchant}}</h6>
                </div>
              </div class="amount">
              <h5 class="mr-2 list-amount"> {{this.amount}}</h5>
            </div>
          </li>
        </a>
      </div>
      <div class="col-1">
        <form action="/record/{{this._id}}?_method=DELETE" method="POST" onsubmit="return confirm('確定要刪除嗎？')">
          <button type="submit" class="delete-btn">
            <i class="fas fa-times"></i>
          </button>
        </form>
      </div>
      {{/each}}
    </div>
  </div>
  <!-- footer -->
  <footer>
    <div class="footer pb-5">
      <a class="logout" href="/users/logout"><img src="/image/logout.png" width="45px" alt="">
        <span class="logout-text">登出</span>
      </a>
    </div>
  </footer>
  <span class="category-amount" style="opacity: 0; position:absolute;">{{categoryAmount}}</sapn>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<script src="/javascripts/amount.js"></script>